# 变更日志

## 版本 0.9.0 (当前版本)

### 🎨 渲染系统升级
- 多渲染模式系统
- 交互体验优化
- 视角动画改进

### ✨ 新增功能
- **多渲染模式**
  - 实心模式：传统实体方块显示
  - 线框模式：空心边框显示效果
  - 透明模式：半透明实体，可透视内部结构
  - 实时切换，即时生效

- **智能碰撞系统**
  - 线框模式下不可见碰撞体确保交互正常
  - 解决线框模式下方块无法创建的问题
  - 保持所有模式下一致的交互体验

- **视角动画优化**
  - 工作空间切换时平滑视角过渡
  - 保持当前相机状态，避免突然跳跃
  - 从当前位置平滑过渡到默认视角

### 🔧 Bug修复与优化
- **交互稳定性**
  - 修复透明模式下方块重复创建问题
  - 解决高强度操作时数据不一致问题
  - 强化双重检查机制，防止重复方块

- **模式切换优化**
  - 修复关卡模式下重力切换时关卡不更新问题
  - 修复关卡模式下视图标签显示错误问题
  - 修复层级设置不同步问题

- **关卡系统优化**
  - 无重力模式下方块生成概率调整为 1/工作空间尺寸
  - 随工作空间增大，方块密度相应降低
  - 关卡难度更加合理和均衡

### 📊 渲染参数详情
- **线框模式**: 线宽2px，颜色0x4CAF50
- **透明模式**: 不透明度50%，边框颜色0x2E7D32
- **实心模式**: 保持原有渲染效果

---

## 版本 0.8.0

### 🚀 重大更新
- 无重力模式系统
- 双重力模式切换
- 层级独立操作

### ✨ 新增功能
- **无重力模式系统**
  - 重力感应/无重力感应双模式切换
  - 层级选择器：+/-按钮切换当前操作层
  - 蓝色半透明平面指示当前层（透明度0.2）
  - 蓝色网格线精确定位方块位置
  - 每层独立操作，互不干扰

- **智能交互逻辑**
  - 射线检测优先级：当前层方块 > 平面交点
  - 左键创建：点击方块不操作，点击空白创建
  - 右键删除：点击方块删除，点击空白不操作
  - 避免射线穿透和误操作问题

- **层级管理系统**
  - 动态占位符更新：只为当前层创建交互平面
  - 实时视觉反馈：当前层高亮显示
  - 层级切换动画：平面和网格线跟随移动
  - 完整的层级隔离：操作严格限制在当前层

### 🔧 技术改进
- 重构交互处理器，支持双模式逻辑
- 优化工作空间构建器，动态占位符管理
- 改进方块管理器，新增层级操作方法
- 完善UI管理器，层级控制界面更新
- 精确的坐标转换和边界检查

---

## 版本 0.7.0

### 🎮 重大更新
- 全新关卡挑战系统
- 双模式切换机制
- UI界面优化升级

### ✨ 新增功能
- **关卡挑战系统**
  - 智能关卡生成：指数分布算法生成合理难度
  - 40%空白区域 + 60%指数分布高度，低高度概率更大
  - 三视图目标显示：正视图、右视图、俯视图
  - 实时验证反馈：绿色正确、红色错误、灰色目标
  - 自动完成检测和提示

- **双模式系统**
  - 自由探索模式：随意搭建，学习三视图原理
  - 关卡挑战模式：根据目标三视图拼搭立体模型
  - 互斥按钮选择，视觉反馈明确
  - 默认启动自由探索模式

- **UI界面优化**
  - 按钮文字更新：“清空”→“自由探索”，“关卡”→“关卡生成”
  - 标准视图按钮重新排列：3行2列布局，与角视图一致
  - 视图按钮顺序优化：正视图、背视图、右视图、左视图、俯视图、仰视图
  - 关卡模式下隐藏“右键切换”提示，界面更简洁

### 🔧 技术改进
- 新增LevelManager模块，完善模块化架构
- 三视图投影算法优化，精确计算X-Y、Z-Y、X-Z平面投影
- Canvas绘制系统，实时更新关卡进度
- 模式状态管理，智能切换视图显示
- 指数分布随机数生成器，参数可调

---

## 版本 0.6.0

### 🚀 重大更新
- 全新键盘相机控制系统
- 动态视觉中心跟随
- 相机移动边界限制

### ✨ 新增功能
- **键盘控制系统**
  - WASD键：前后左右移动相机
  - 方向键↑↓：相机上下移动（Y轴）
  - 方向键←→：绕视觉中心顺时针/逆时针旋转
  - 流畅的3D空间导航体验

- **动态视觉中心**
  - 视觉中心跟随相机移动
  - 鼠标拖拽和滚轮操作基于当前视觉中心
  - 旋转操作围绕动态中心点进行
  - 预设视图自动重置视觉中心为原点

- **智能边界限制**
  - 相机移动范围限制为工作空间大小×2
  - 防止相机移动过远迷失方向
  - 根据工作空间尺寸动态调整边界
  - 保持合理的探索空间

### 🔧 技术改进
- 修复正交相机视野自适应问题
- 优化相机距离计算公式
- 改进鼠标操作与键盘控制的协调性
- 增强用户操作体验和空间感知

---

## 版本 0.5.0

### 🚀 重大更新
- 模块化架构重构
- 代码拆分为7个独立模块
- 可变工作空间大小系统

### ✨ 新增功能
- **模块化架构**
  - 7个独立模块：主入口、场景管理、相机管理、工作空间构建、方块管理、交互处理、历史管理
  - 依赖注入设计模式
  - 职责分离，单一功能原则
  - 向后兼容的API接口

- **可变工作空间**
  - 支持3×3×3、5×5×5、7×7×7、9×9×9四种尺寸
  - 动态网格线和坐标轴适配
  - 实时重建工作空间元素

### 🔧 技术改进
- 代码量从650行拆分为7个小文件
- 提升可维护性和可扩展性
- 优化代码结构和依赖关系
- 删除冗余代码约30行

---

## 版本 0.4.0

### 🚀 重大更新
- 14视图系统（6标准+8角视图）
- 重力删除逻辑优化
- 全角度检测支持

### ✨ 新增功能
- **14视图系统**
  - 6个标准视图：顶、底、前、后、左、右
  - 8个角视图：从正方体8个角观察中心
  - 紧凑网格布局，优化界面空间利用

- **重力删除系统**
  - 只能删除每个XZ位置的最顶层方块
  - 点击中间方块无反应，避免浮空方块
  - 与添加逻辑形成完美逆向操作

- **全角度检测**
  - 双面渲染检测平面，支持从任何角度创建方块
  - 修复底部视角无法创建方块的问题
  - 保持原有检测逻辑不变

### 🔧 技术改进
- 四元数插值动画，解决视角切换瞬移问题
- 精确的顶层方块检测算法
- 优化界面布局和按钮尺寸
- 提升用户交互体验和操作精度

---

## 版本 0.3.0

### 🚀 重大更新
- 撤回/重做功能系统
- 代码重构和优化
- 底部点击检测修复

### ✨ 新增功能
- **撤回/重做系统**
  - 双栈技术实现撤回和重做
  - 支持最多50步历史记录
  - 快捷键支持：Ctrl+Z（撤回）、Ctrl+Shift+Z/Ctrl+Y（重做）
  - 自动状态保存机制

- **代码优化**
  - 删除冗余代码和未使用方法
  - 提取公共方法减少重复代码
  - 简化轴标签创建逻辑
  - 统一方块创建流程

- **交互改进**
  - 修复底部平面点击检测精度问题
  - 优化坐标转换算法
  - 改进射线投射器设置
  - 精确的网格位置映射

### 🔧 技术改进
- 重构方块创建系统（分离直接创建和状态保存）
- 优化内存使用（历史记录限制）
- 改进代码可维护性
- 减少约100行冗余代码

---

## 版本 0.2.0

### 🚀 重大更新
- 全新的交互逻辑和坐标系统
- 改进的视图切换动画
- 优化的点击检测机制

### ✨ 新增功能
- **坐标系统**
  - 右手坐标系（X右，Y上，Z向外）
  - 彩色坐标轴指示器（X红，Y绿，Z蓝）
  - 坐标轴标签显示

- **交互改进**
  - 左键点击：添加方块（点击现有方块在其上方添加，点击底部平面创建第一层）
  - 右键点击：删除被点击的方块
  - 精确的射线检测，避免误操作
  - 智能方块堆叠系统

- **视图切换**
  - 平滑的相机动画过渡
  - 同时插值位置和up向量
  - 标准正交视图对齐
  - 1秒缓动动画效果

- **点击检测优化**
  - 底部5×5检测平面
  - 交点位置验证机制
  - 容差范围内的精确匹配
  - 多方块重叠时的正确选择

### 🔧 技术改进
- 重构了点击检测逻辑
- 优化了方块创建和删除流程
- 改进了相机控制系统
- 增强了用户交互体验

---

## 版本 0.1.0

### 🎉 首次发布
- 完整的5×5×5方块搭建系统
- 四视图实时同步显示功能

### ✨ 基础功能
- **工作区域**
  - 5×5×5立体工作空间（125个位置）
  - 3D网格线系统（底面、左面、后面）
  - 透明占位方块提升点击精度

- **交互系统**
  - 基础的点击添加/删除方块
  - 鼠标拖拽360度旋转视角
  - 滚轮缩放（3-20倍距离）
  - 一键清空工作区

- **视图系统**
  - 透视图（主视图，70%界面）
  - 正视图（X-Y平面投影）
  - 侧视图（Y-Z平面投影）
  - 俯视图（X-Z平面投影）
  - 四视图实时同步更新

- **渲染优化**
  - WebGL硬件加速渲染
  - 实时光照系统（环境光+方向光）
  - 方块边缘线框显示
  - 响应式界面设计